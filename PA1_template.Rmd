---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
```{r,echo=TRUE}
library(plyr)
read.csv('./activity.csv',header=TRUE,colClasses=c('integer','Date','integer'))->x

z<-ddply(x,'interval',summarise,mean(steps,na.rm=TRUE))
```


## What is mean total number of steps taken per day?
```{r,echo=TRUE}
y<-ddply(x,"date",summarise,sum(steps))

hist(y[,2],breaks=10,main="Frequency of Steps per Day",xlab="Total Number of Steps per Day")
```
<br>
The average number of steps/day is
```{r,echo=TRUE}
mean(y[,2],na.rm=TRUE)
```
and the median is
```{r,echo=TRUE}
median(y[,2],na.rm=TRUE)
```

## What is the average daily activity pattern?
```{r,echo=TRUE}
plot(z[,1],z[,2],type='l',ylim=c(0,200),main="Average Number of Steps per Interval",ylab="Average Number of Steps",xlab='5 Minute Interval')

```
<br>the highest average number of steps in a mintue minute interval is

```{r,echo=TRUE}

z[z$..1==max(z[,2]),1]
```

## Imputing missing values

The number of missing values are:
```{r}
nrow(x[is.na(x$steps),])
```

```{r}
w<-x
for ( i in seq(1,nrow(w))) {
  if (is.na(w[i,1])) {w[i,1]<-z[z$interval==w[i,3],2] } }

u<-ddply(w,"date",summarise,sum(steps))

hist(u[,2],breaks=10,main="Frequency of Steps per Day",xlab="Total Number of Steps per Day")
```

the new mean and median are:
```{r}
mean(u[,2],na.rm=TRUE)
median(u[,2],na.rm=TRUE)
```

write some information here


## Are there differences in activity patterns between weekdays and weekends?

```{r,echo=TRUE}
u<-x

a<-c()
for (i in seq(1,nrow(u))) {
  if(weekdays(u[i,2])=="Saturday" || weekdays(u[i,2])=="Sunday") {a[i]<-"Weekend"}
  else {a[i]<-"Weekday"} }
u$day<-a
u$day<-factor(u$day)

v<-ddply(u,c('interval','day'),summarise,mean(steps,na.rm=TRUE))



par(mfrow=c(2,1))
plot(v[v$day=="Weekday",1],v[v$day=="Weekday",3],type="l",xlim=c(0,2355),ylim=c(0,210))
plot(v[v$day=="Weekend",1],v[v$day=="Weekend",3],type="l",xlim=c(0,2355),ylim=c(0,210))

```